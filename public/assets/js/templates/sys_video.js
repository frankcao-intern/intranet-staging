
require(['jquery','lib/jquery.cycle.all'],function($){'use strict';var Engine={videoRotator:function(){$('.video-rotator').each(function(){var $container=$(this),$rotatorControls=$('.rotator-controls',$container),$next=$('.next',$rotatorControls),$prev=$('.prev',$rotatorControls),$current=$('.min',$rotatorControls),$items=$('.items',$container),$playButton=$('<img>').attr('src',coreEngine.siteRoot+"assets/images/button-play-a.png").addClass('video-btn-play').css({display:'none',left:'36.5px',position:'absolute',top:'10px'});$container.find('.max').text($('.items .thumb',$container).length);$current.text('1-'+$('> ul > li:first',$items).find('.item').length);$('.thumb',$items).each(function(i){$(this).data('index',i+1);});$('li',$items).each(function(){$('.item',this).equalHeights(127);});$('> ul > li',$items).equalHeights(384);$('p.thumb a',$items).bind('click',function(){var $primary=$(".primary",$container),$item=$(this).addClass('active').parent().parent(),page_id=$(this).attr('href'),src=coreEngine.siteRoot+'article/'+page_id+'/layout/embed/w/{1}/h/{2}',$iframe;$('.active',$items).removeClass('active');$primary.find('.caption').remove();$item.find("div.caption").clone().appendTo($primary).show();$iframe=$('iframe',$container);$iframe.attr('src',src.format($iframe.width(),$iframe.height()));return false;}).bind('mouseenter',function(){$('img.video-btn-play',this).show();}).bind('mouseleave',function(){$('img.video-btn-play',this).hide();});$('.item',$items).each(function(){$('.caption',this).hide();$('a',this).append($playButton);}).filter(':first').find('p.thumb > a').addClass('active').click();$items.find('ul').cycle({fx:'scrollHorz',speed:'fast',timeout:0,prev:$prev,next:$next,after:function(curr,next){$current.text($(next).find('.thumb:first').data('index')+'-'+$(next).find('.thumb:last').data('index'));}});});}};$(document).ready(function(){Engine.videoRotator();});});