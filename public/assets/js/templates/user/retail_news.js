
require(['jquery','shared/minicalendar','lib/jquery.quicksearch','lib/fullcalendar'],function($){'use strict';if($('html').hasClass('.oldie')&&(coreEngine.editMode===false)){require(['lib/jquery.columnizer']);}
var Engine={$context:$(),getContext:function(){if($("ul.ui-tabs-nav").length>0){Engine.$context=$($("ul.ui-tabs-nav li.ui-state-active a").attr('href'));}else{Engine.$context=$('section.primary');}},quickSearch:function(){$('#quickSearch',Engine.$context).click(function(){$(this).quicksearch($('ul.forms-list li',Engine.$context));});},columnize:function(){var $tmp=$('ul.forms-list',Engine.$context),numColumns=window.parseInt($('#pageColumns',Engine.$context).val());if($tmp.columnize){if(numColumns>1){$tmp.columnize({columns:numColumns});$(".column",Engine.$context).width(Math.floor($tmp.width()/numColumns-(21-21/numColumns)));}}else{$tmp.css({'-webkit-column-count':String(numColumns),'-webkit-column-rule':'1px dotted #BBBBBB','-webkit-column-gap':'24px','-moz-column-count':String(numColumns),'-moz-column-rule':'1px dotted #BBBBBB','-moz-column-gap':'24px','-ms-column-count':String(numColumns),'-ms-column-rule':'1px dotted #BBBBBB','-ms-column-gap':'24px','column-count':String(numColumns),'column-rule':'1px dotted #BBBBBB','column-gap':'24px'});}},calendar:function(){var cur_date=$('.article-header time').attr('datetime'),date_parts=cur_date.match(/(\d+)/g);$('#calendar').empty().fullCalendar({slotMinutes:30,theme:true,year:date_parts[0],month:date_parts[1]-1,date:date_parts[2],buttonIcons:{prev:'triangle-1-w',next:'triangle-1-e'},header:false,weekMode:'fluid',defaultView:'basicWeek',height:200,eventSources:[{events:function(startParam,endParam,callback){var myCallback=function(result){callback(result.events);},start=Math.round(startParam.getTime()/1000),end=Math.round(endParam.getTime()/1000);coreEngine.getJSON('calendar/fullcal_json/'+17+'/'+start+'/'+
end+'/'+(new Date()).getTime(),'',myCallback);},color:'#76a06c',textColor:'#FFF'}],lazyLoading:true,titleFormat:{week:"MMMM d[ yyyy]{ '&#8212;'[ MMM] d, yyyy}"}});},miniCalendar:function(){var $minicalendar=$("#miniCalendar"),cal_id=$minicalendar.text();$minicalendar.miniCalendar({'cal_id':cal_id});}};$(document).ready(function(){Engine.getContext();Engine.columnize();Engine.quickSearch();Engine.calendar();Engine.miniCalendar();});});