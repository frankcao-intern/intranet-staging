
require(['jquery','lib/jquery.cycle.all'],function($){'use strict';var Engine={gallery:function(){$('.gallery').each(function(){var $this=$(this),$galleryUL=$('.primary ul',$this),$galleryNav=$('.gallery-nav',$this),$thumbsPager=$('.pagination',$galleryNav),$thumbsUL=$('ul.thumbs',$this),$thumbsLI=$('li',$thumbsUL),$controls=$('.controls',$galleryNav),$caption=$('.secondary .caption',$this),creditsTempl=$("#creditsTempl").text(),inactiveThumbnailOpacity=0.50,onSlideChangeDuration=0,activateThumb;activateThumb=function(idx){var $img,api;$img=$('img:eq('+idx+')',$galleryUL);$('.image-title',$caption).text($img.attr('alt'));$('.image-credits',$caption).empty().append(coreEngine.attachTemplateToData(creditsTempl,[{href:$img.parent().attr('href'),credits:($img.data('credit')==='')?"":'Photo by: '+$img.data('credit')+' - '}]));$('.image-desc',$caption).text($img.data('desc'));api=$caption.data('jsp');if(api){api.reinitialise();}else{$caption.jScrollPane({verticalGutter:12});}
$thumbsLI.removeClass('active').eq(idx).addClass('active').fadeTo(onSlideChangeDuration,1);};$galleryUL.cycle({speed:'fast',timeout:4000,next:$('.next',$controls),prev:$('.prev',$controls),onPrevNextEvent:function(isNext,idx){var $li=$thumbsLI.eq(idx);$('a.page-'+$li.parent('div.page').index(),$thumbsPager).click();},pagerEvent:'mouseenter',onPagerEvent:function(slideIndex){activateThumb(slideIndex);},activePagerClass:'',allowPagerClickBubble:false,pagerAnchorBuilder:function(idx){return $thumbsLI.eq(idx);},before:function(){$thumbsLI.fadeTo(onSlideChangeDuration,inactiveThumbnailOpacity);},after:function(curr,next,opts){activateThumb(opts.currSlide);}});$thumbsLI.eq(0).trigger('mouseenter');if($thumbsUL.children().length>1){$("<a>").addClass('prev').text('Prev').prependTo($thumbsPager);$('<a>').addClass('next').text('Next').appendTo($thumbsPager);}
$thumbsUL.cycle({fx:'scrollHorz',speed:'fast',timeout:0,pager:$('span.pager',$thumbsPager),next:'.top.pagination a.next',prev:'.top.pagination a.prev',pagerAnchorBuilder:function(idx){return'<a href="#" class="page-'+idx+'">'+(idx+1)+'<\/a>';},before:function(curr){$('div.page',$thumbsUL).removeClass('active');$(curr).addClass('active');},after:function(){}});$('.play',$controls).css('cursor','pointer').click(function(){$galleryUL.cycle('toggle');$(this).toggleClass('play').toggleClass('pause').text($(this).attr('class')).css({'text-transform':'capitalize'});});$galleryUL.cycle('pause');});}};Engine.gallery();});