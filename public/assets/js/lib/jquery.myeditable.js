
(function($,undefined){'use strict';$.editable={type:'textInline',save:null,saveText:'Save',cancelText:'Cancel',showLink:true};$.fn.editable=function(opts){var options=$.extend({},$.editable,opts);this.each(function(){var $this=$(this).addClass('editable-region'),content=$this.html(),$link;if(!$this.data('editable')){$this.data('editable',options).empty().append('<div>'+content+'<\/div>');if($.editableWidgets[options.type]!==undefined){$.editableWidgets[options.type].apply(this);if(options.showLink===true){$link=$("<a>",{"href":"#","class":"editable-link","html":"&mdash;Edit"}).click(function(){$(this).siblings('div').click();});$(this).append($link);}}}});return this;};$.editableWidgets={textInline:function(){$(this).children('div').click(function(){var value=$(this).text(),$inlineInput=$('<input>',{'type':"text",'style':"width: 100%"}),save=function(){var $input=$(this),content=$input.val(),editable=$input.closest('.editable-region').data('editable'),$div=$input.siblings('div');$div.text(content).show();editable.save.apply($input.closest('.editable-region'));$input.remove();};$inlineInput.val(value).keydown(function(e){if(e.keyCode===13){save.apply(this);return false;}else
if(e.keyCode===27){$(this).siblings('div').show();$(this).remove();return false;}
return true;}).blur(function(){save.apply(this);});$(this).hide().closest('.editable-region').append($inlineInput);$inlineInput.focus().select();});return true;},textarea:function(){$(this).children('div').click(function(){var $dialogTextArea=$('<textarea>',{rows:"8",cols:"80",style:"width:80%"}),$div=$(this),content=$div.text(),editable=$div.closest('.editable-region').data('editable');content=content.replace(/<\s*br\s*\/?\s*>/gi,"\n");content=content.replace(/\n+/g,"");$dialogTextArea.val(content);$('<div>',{title:"Editor",style:"text-align: center;"}).append($dialogTextArea).dialog({bgiframe:true,resizable:false,width:500,modal:false,buttons:[{text:editable.saveText,click:function(){var $input=$('textarea',this),content=$input.val();content=content.replace(/(<([^>]+)>)/ig,"");content=content.replace(/\n/g,"<br />");$div.html(content);editable.save.apply($div.closest('.editable-region'));$(this).dialog('close');}},{text:editable.cancelText,click:function(){$(this).dialog("close");}}]});$dialogTextArea.focus().select();});return true;},wysiwyg:function(){$(this).children('div').click(function(){var $dialogTextArea=$('<textarea>',{"class":"tinymce",style:"width: 760px;"}),$div=$(this),editable=$div.closest('.editable-region').data('editable');$('<div>',{title:"WYSIWYG Editor",style:"text-align: center;"}).append($dialogTextArea).dialog({bgiframe:true,resizable:false,width:790,modal:false,buttons:[{text:editable.saveText,click:function(){var $input=$('textarea',this),content=$input.html();$div.html(content);editable.save.call($div.closest('.editable-region'),content);$(this).dialog('close');}},{text:editable.cancelText,click:function(){$(this).dialog("close");}}]});$dialogTextArea.focus().select();$dialogTextArea.tinymce($.extend({},{setup:function(ed){ed.onInit.add(function(ed){$('#'+ed.id).val($div.html());});}},editable.tinyMCEOpts));});return true;},datepicker:function(){$(this).children('div').click(function(){var value=$(this).text(),options=$(this).closest('.editable-region').data('editable'),$inlineInput=$('<input>',{'type':"text"}),save=function(){var $input=$(this),content=$input.val(),$div=$input.siblings('div');$div.text(content).show();options.save.apply($input.closest('.editable-region'));$input.remove();};$inlineInput.val(value).datepicker({dateFormat:options.dateFormat,onSelect:function(){save.apply(this);}}).keydown(function(e){if(e.keyCode===13){save.apply(this);return false;}else
if(e.keyCode===27){$(this).siblings('div').show();$(this).remove();return false;}
return false;});$(this).hide().closest('.editable-region').append($inlineInput);$inlineInput.focus().select();});return true;}};}(jQuery));